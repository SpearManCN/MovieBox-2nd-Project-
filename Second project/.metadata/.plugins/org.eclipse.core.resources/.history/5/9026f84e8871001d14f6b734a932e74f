<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.naver.erp.Board">

<sql id="keywordwhere">
	 <!-- 검색어 입력이 비어있지 않을 경우 -->
	<if test="keyword !=null and keyword.length()>0">
		<!-- select 가 '제목' 일 경우-->
		<if test="keywordtype =='title'">
		where upper(title) like upper('%${keyword}%')
		</if>
		
		<!-- select 가 '내용' 일 경우 -->
		<if test="keywordtype =='content'">
		where upper(content) like upper('%${keyword}%')
		</if>
		
		<!-- select 가 '이메일' 일 경우 -->
		<if test="keywordtype=='email'">
		 where upper(email) like upper('%${keyword}%') 
		</if>
	</if>
</sql>



<!-- 자주 묻는 질문 게시판 DB 에 저장된 목록 -->
<select id="getBoardQuestionList"  parameterType="com.naver.erp.BoardSearchDTO" resultType="java.util.HashMap">
select * from ( select rownum RNUM, zxcvb. * from (
	SELECT no       		 as "no"     
	,email        			 as "email"  
	,title          			 as "title"  
	,content        		 as "content"  
	,readCount   		 as "readCount"  
	,to_char(regDate,'YYYY-MM-DD')     			 as "regDate"  
	,reportCount 		 as "reportCount"  
	,commentCount 		 as "commentCount"  
	,issecret          		 as "issecret"  
	,partNo 				 as "partNo"  
FROM QUESTION

   <include refid="keywordwhere"></include>
	
	<if test="sort==null or sort.length()==0" >
                        order by
                           no desc
                           ,regDate desc 
                     </if>
                        
                     <if test="sort!=null and sort.length()>0" >
                        order by ${sort}
                     </if>
<![CDATA[
	) zxcvb) where RNUM >= #{begin_rowNo} and RNUM <= #{end_rowNo}
]]>

</select>
<!-- 자주 묻는 질문 조회수 1 증가 -->
<update id="questionUpReCount" parameterType="int">
UPDATE QUESTION SET READCOUNT = NVL(READCOUNT,0)+1 WHERE NO =#{no}
</update>

<!-- 자주묻는질문 중 선택된 글 -->
<select id="questionBoardSelected"  parameterType="int" resultType="com.naver.erp.BoardQuestionDTO">
SELECT no             
	,email        
	,title          
	,content     
	,readCount 
	,to_char(regDate,'YYYY-MM-DD') AS regDate    
	,reportCount
	,commentCount
	,issecret         
	,partNo
FROM QUESTION WHERE NO=#{no}
</select>

<!-- 검색된 자주 묻는 질문 글 목록 총 개수 -->
<select id="boardQuesitonListTotCnt"  parameterType="com.naver.erp.BoardSearchDTO" resultType="int">
	SELECT
		COUNT(*)
	FROM
		QUESTION
<include refid="keywordwhere"></include>
</select>





















<!-- 공지사항 DB 에 저장된 목록 -->
<select id="getBoardNoticeList"  parameterType="com.naver.erp.BoardSearchDTO" resultType="java.util.HashMap">
select * from ( select rownum RNUM, zxcvb. * from (
	SELECT no       		 as "no"     
	,email        			 as "email"  
	,title          			 as "title"  
	,content        		 as "content"  
	,readCount   		 as "readCount"  
	,to_char(regDate,'YYYY-MM-DD')     			 as "regDate"  
	,reportCount 		 as "reportCount"  
	,commentCount 		 as "commentCount"  
	,issecret          		 as "issecret"  
	,partNo 				 as "partNo"  
FROM NOTICE

<include refid="keywordwhere"></include>
	
	<if test="sort==null or sort.length()==0" >
                        order by
                           no desc
                           ,regDate desc 
                     </if>
                        
                     <if test="sort!=null and sort.length()>0" >
                        order by ${sort}
                     </if>
<![CDATA[
	) zxcvb) where RNUM >= #{begin_rowNo} and RNUM <= #{end_rowNo}
]]>
</select>
<!-- 공지사항 조회수 1 증가 -->
<update id="noticeUpReCount" parameterType="int">
UPDATE NOTICE SET READCOUNT = NVL(READCOUNT,0)+1 WHERE NO =#{no}
</update>

<!-- 공지사항 중 선택된 글 -->
<select id="noticeBoard"  parameterType="int" resultType="com.naver.erp.BoardNoticeDTO">
SELECT no             
	,email        
	,title          
	,content     
	,readCount 
	,to_char(regDate,'YYYY-MM-DD') AS regDate    
	,reportCount
	,commentCount
	,issecret         
	,partNo
FROM NOTICE WHERE NO=#{no}
</select>

<!-- 검색된 공지사항 글 목록 총 개수 -->
<select id="noticeBoardListTotCnt"  parameterType="com.naver.erp.BoardSearchDTO" resultType="int">
	SELECT
		COUNT(*)
	FROM
		NOTICE
	<include refid="keywordwhere"></include>
</select>



</mapper>